"use strict";(()=>{var e={};e.id=436,e.ids=[436],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},23983:(e,s,t)=>{t.r(s),t.d(s,{headerHooks:()=>w,originalPathname:()=>f,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>x});var a={};t.r(a),t.d(a,{POST:()=>POST}),t(78976);var r=t(10884),o=t(16132),n=t(38258),i=t(71409),u=t(45764);function jsonResponse(e,s=200){return new Response(JSON.stringify(e),{status:s,headers:{"Content-Type":"application/json"}})}async function POST(e){try{await (0,n.default)();let{token:s,password:t}=await e.json();if(!s||!t)return jsonResponse({success:!1,message:"Datos incompletos"},400);let a=await i.default.findOne({resetToken:s,resetTokenExpiry:{$gt:Date.now()}});if(!a)return jsonResponse({success:!1,message:"El token es inv\xe1lido o ha expirado"},400);let r=await u.default.genSalt(10);return a.password=await u.default.hash(t,r),a.resetToken=void 0,a.resetTokenExpiry=void 0,await a.save(),jsonResponse({success:!0,message:"Contrase\xf1a actualizada correctamente"})}catch(e){return console.error("Reset Password Error:",e),jsonResponse({success:!1,message:"Error al restablecer la contrase\xf1a"},500)}}let p=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/reset-password/route",pathname:"/api/auth/reset-password",filename:"route",bundlePath:"app/api/auth/reset-password/route"},resolvedPagePath:"C:\\einflix\\app\\api\\auth\\reset-password\\route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:l,headerHooks:w,staticGenerationBailout:x}=p,f="/api/auth/reset-password/route"}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[364,764,258,409],()=>__webpack_exec__(23983));module.exports=t})();