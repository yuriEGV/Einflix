"use strict";(()=>{var e={};e.id=351,e.ids=[351],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},84257:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>y,originalPathname:()=>k,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>x});var r={};t.r(r),t.d(r,{GET:()=>GET,POST:()=>POST,dynamic:()=>c}),t(78976);var n=t(10884),i=t(16132),o=t(95798),u=t(38258),s=t(71409);let c="force-dynamic";async function GET(e){try{await (0,u.Z)();let{searchParams:a}=new URL(e.url),t=a.get("status"),r=a.get("external_reference");if("approved"===t&&r)return await s.Z.findByIdAndUpdate(r,{isPaid:!0,subscriptionExpiry:new Date(Date.now()+2592e6)}),o.redirect(new URL("/gallery?payment=success",e.url));return o.redirect(new URL("/payment?status=failed",e.url))}catch(a){return console.error("Error Callback:",a.message),o.redirect(new URL("/payment?status=error",e.url))}}async function POST(e){return GET(e)}let p=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/payment/callback/route",pathname:"/api/auth/payment/callback",filename:"route",bundlePath:"app/api/auth/payment/callback/route"},resolvedPagePath:"C:\\einflix\\app\\api\\auth\\payment\\callback\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m,headerHooks:y,staticGenerationBailout:x}=p,k="/api/auth/payment/callback/route"}};var a=require("../../../../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[364,798,764,792],()=>__webpack_exec__(84257));module.exports=t})();