"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},20350:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>d,originalPathname:()=>m,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>c,staticGenerationAsyncStorage:()=>u,staticGenerationBailout:()=>g});var o={};s.r(o),s.d(o,{POST:()=>POST}),s(78976);var t=s(10884),i=s(16132),a=s(38258),n=s(71409);function jsonResponse(e,r=200){return new Response(JSON.stringify(e),{status:r,headers:{"Content-Type":"application/json"}})}async function POST(e){console.log("=== REGISTER REQUEST ===");try{let r;await (0,a.default)();try{r=await e.json()}catch(e){throw console.error("Error parsing body:",e),Error("Invalid XML/JSON body")}let{name:o,email:t,password:i}=r;console.log("Registering:",t);let l=await n.default.findOne({email:t.toLowerCase()});if(l)return jsonResponse({success:!1,message:"El correo ya est\xe1 registrado"},400);console.log("Importing bcrypt...");let p=await Promise.resolve().then(s.bind(s,45764)),u=p.default||p;console.log("Hashing password...");let c=await u.genSalt(10),d=await u.hash(i,c),g=await n.default.create({name:o,email:t,password:d});console.log("User created:",g._id);try{console.log("Configuring email transporter...");let e=await s.e(709).then(s.t.bind(s,66709,19)),r=e.createTransport({service:"gmail",auth:{user:process.env.EMAIL_USER,pass:process.env.EMAIL_PASS}}),i={from:process.env.EMAIL_USER,to:t,subject:"\xa1Bienvenido a Einflix!",html:`
                    <div style="font-family: Arial, sans-serif; color: #333;">
                        <h1 style="color: #E50914;">Bienvenido a Einflix</h1>
                        <p>Hola <strong>${o}</strong>,</p>
                        <p>Gracias por registrarte en nuestra plataforma.</p>
                        <p>Tus credenciales de acceso son:</p>
                        <ul>
                            <li><strong>Email:</strong> ${t}</li>
                            <li><strong>Contrase\xf1a:</strong> (La que definiste al registrarte)</li>
                        </ul>
                        <p>Disfruta del mejor contenido en streaming.</p>
                        <br>
                        <p>Atentamente,<br>El equipo de Einflix</p>
                    </div>
                `};process.env.EMAIL_USER&&process.env.EMAIL_PASS?(console.log("Sending welcome email..."),await r.sendMail(i),console.log("Email sent successfully.")):console.log("Skipping email: EMAIL_USER or EMAIL_PASS not set in .env")}catch(e){console.error("Error sending email:",e)}return jsonResponse({success:!0,message:"Usuario registrado con \xe9xito",user:{id:g._id,name:g.name,email:g.email}})}catch(e){return console.error("Register Error:",e),jsonResponse({success:!1,message:"Error al registrar usuario: "+e.message},500)}}let l=new t.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\einflix\\app\\api\\auth\\register\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:u,serverHooks:c,headerHooks:d,staticGenerationBailout:g}=l,m="/api/auth/register/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[364,764,258,409],()=>__webpack_exec__(20350));module.exports=s})();