"use strict";(()=>{var e={};e.id=261,e.ids=[261],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},71017:e=>{e.exports=require("path")},20583:(e,t,i)=>{i.r(t),i.d(t,{headerHooks:()=>f,originalPathname:()=>x,requestAsyncStorage:()=>u,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>g});var o={};i.r(o),i.d(o,{GET:()=>GET,dynamic:()=>c}),i(78976);var r=i(10884),a=i(16132);i(95798);var s=i(57147),l=i(71017),n=i(23858);let c="force-dynamic",p=process.env.JWT_SECRET||"einflix_super_secret_key_2024";async function GET(e){try{let t=e.cookies.get("session_token")?.value,o="none";if(t)try{let e=new TextEncoder().encode(p),{payload:r}=await (0,n._)(t,e),a=(await Promise.all([i.e(764),i.e(409)]).then(i.bind(i,71409))).default,s=(await i.e(258).then(i.bind(i,38258))).default;await s();let l=await a.findById(r.id);l&&l.isPaid&&(o=l.planType||"basic")}catch(e){console.error("Token verification failed in catalog:",e)}let r=l.join(process.cwd(),"data"),a=[];a="total"===o?["peliculas.txt","series.txt","comics.txt","musica.txt","karaoke.txt","libros.txt","otros.txt"]:"medium"===o?["peliculas.txt","series.txt"]:"basic"===o?["libros.txt"]:[];let c=[];for(let[e,t]of Object.entries({"peliculas.txt":"Pel\xedcula","series.txt":"Serie","comics.txt":"Comic","musica.txt":"M\xfasica","karaoke.txt":"Karaoke","libros.txt":"Libro","otros.txt":"Otros"})){if(!a.includes(e))continue;let i=l.join(r,e);if(s.existsSync(i)){let e=s.readFileSync(i,"utf8"),o=e.split("\n").filter(e=>e.trim()),r=o.map(e=>{let i=e.split("|").map(e=>e.trim()),o=i[0]||"",r=o.match(/[-\w]{25,}/),a=r?r[0]:null;return a?{id:a,title:i[1]||`Contenido ${a.slice(0,6)}`,tags:i[2]?[i[2]]:[t],cover:i[3]||null,description:i[4]||"Sin descripci\xf3n disponible.",folderUrl:o}:null}).filter(Boolean);c=c.concat(r)}}if(0===c.length){let e=l.join(r,"drive_links.txt");if(s.existsSync(e)){let t=s.readFileSync(e,"utf8"),i=t.split("\n").filter(e=>e.trim());c=i.map(e=>{let t=e.split("|").map(e=>e.trim()),i=t[0]||"",o=i.match(/[-\w]{25,}/),r=o?o[0]:null;return r?{id:r,title:t[1]||`Contenido ${r.slice(0,6)}`,tags:t[2]?[t[2]]:[],cover:t[3]||null,description:t[4]||"Sin descripci\xf3n disponible.",folderUrl:i}:null}).filter(Boolean)}}let d={pelicula:"https://images.unsplash.com/photo-1485846234645-a62644f84728?w=800&q=80",serie:"https://images.unsplash.com/photo-1522869635100-9f4c5e86aa37?w=800&q=80",anime:"https://images.unsplash.com/photo-1578632738980-433120152918?w=800&q=80",novedades:"https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=800&q=80",maratón:"https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?w=800&q=80",favoritos:"https://images.unsplash.com/photo-1478720568477-152d9b164e26?w=800&q=80",colección:"https://images.unsplash.com/photo-1461360370896-922624d12aa1?w=800&q=80",streaming:"https://images.unsplash.com/photo-1593784991095-a205069470b6?w=800&q=80",premium:"https://images.unsplash.com/photo-1550745165-9bc0b25272a7?w=800&q=80",biblioteca:"https://images.unsplash.com/photo-1507014498014-97050e8902f2?w=800&q=80",galería:"https://images.unsplash.com/photo-1492037766660-2a56f9eb3fcb?w=800&q=80",einflix:"https://images.unsplash.com/photo-1574375927938-d5a98e8ffe85?w=800&q=80"},u=c.map(e=>{let t=e.id;if(!t)return null;let i=!e.folderUrl||e.folderUrl.includes("/folders/"),o=e.tags||[],r=o[0]||(i?"Carpeta":"Multimedia");r=r.charAt(0).toUpperCase()+r.slice(1);let a=e.cover||`/api/drive/thumbnail?id=${t}`;if(a.includes("drive.google.com/thumbnail")){let e=o.map(e=>e.toLowerCase());for(let[t,i]of Object.entries(d))if(e.includes(t)){a=i;break}}return{id:t,title:e.title||`Contenido ${t.slice(0,6)}`,category:r,description:e.description||"Sin descripci\xf3n disponible.",type:i?"folder":"video",original:i?`https://drive.google.com/embeddedfolderview?id=${t}#grid`:e.folderUrl||`https://drive.google.com/file/d/${t}/view`,preview:i?`https://drive.google.com/embeddedfolderview?id=${t}#grid`:`https://drive.google.com/file/d/${t}/preview`,thumbnail:a}}).filter(Boolean),m=new Set;return(u=u.filter(e=>{let t=m.has(e.id);return m.add(e.id),!t})).sort((e,t)=>e.title.localeCompare(t.title)),new Response(JSON.stringify(u),{headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error en la API de Catalogo:",e),new Response(JSON.stringify({error:"Error interno del servidor"}),{status:500,headers:{"Content-Type":"application/json"}})}}let d=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/drive/catalogo/route",pathname:"/api/drive/catalogo",filename:"route",bundlePath:"app/api/drive/catalogo/route"},resolvedPagePath:"C:\\einflix\\app\\api\\drive\\catalogo\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:f,staticGenerationBailout:g}=d,x="/api/drive/catalogo/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),i=t.X(0,[364,935,798,858],()=>__webpack_exec__(20583));module.exports=i})();