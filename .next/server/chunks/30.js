"use strict";exports.id=30,exports.ids=[30],exports.modules={57030:(e,t,r)=>{r.d(t,{N:()=>SignJWT});var s=r(40554),a=r(55270),i=r(91715),d=r(24929);async function sign(e,t,r){let s=await (0,d.f)(e,t,"sign");(0,i.F)(e,s);let n=await crypto.subtle.sign((0,a.O)(e,s.algorithm),s,r);return new Uint8Array(n)}var n=r(57826),o=r(16395),c=r(52820),h=r(51823),p=r(10618),u=r(17890);let FlattenedSign=class FlattenedSign{#e;#t;#r;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#e=e}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setUnprotectedHeader(e){if(this.#r)throw TypeError("setUnprotectedHeader can only be called once");return this.#r=e,this}async sign(e,t){let r,a,i,d;if(!this.#t&&!this.#r)throw new o.GW("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,n.e)(this.#t,this.#r))throw new o.GW("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let l={...this.#t,...this.#r},w=(0,p.E)(o.GW,new Map([["b64",!0]]),t?.crit,this.#t,l),H=!0;if(w.has("b64")&&"boolean"!=typeof(H=this.#t.b64))throw new o.GW('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:y}=l;if("string"!=typeof y||!y)throw new o.GW('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,h.y)(y,e,"sign"),H?(r=(0,s.c)(this.#e),a=(0,c.cv)(r)):(a=this.#e,r=""),this.#t?(i=(0,s.c)(JSON.stringify(this.#t)),d=(0,c.cv)(i)):(i="",d=new Uint8Array);let g=(0,c.zo)(d,(0,c.cv)("."),a),f=await (0,u.k)(e,y),b=await sign(y,f,g),m={signature:(0,s.c)(b),payload:r};return this.#r&&(m.header=this.#r),this.#t&&(m.protected=i),m}};let CompactSign=class CompactSign{#s;constructor(e){this.#s=new FlattenedSign(e)}setProtectedHeader(e){return this.#s.setProtectedHeader(e),this}async sign(e,t){let r=await this.#s.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}};var l=r(61868);let SignJWT=class SignJWT{#t;#a;constructor(e={}){this.#a=new l.V$(e)}setIssuer(e){return this.#a.iss=e,this}setSubject(e){return this.#a.sub=e,this}setAudience(e){return this.#a.aud=e,this}setJti(e){return this.#a.jti=e,this}setNotBefore(e){return this.#a.nbf=e,this}setExpirationTime(e){return this.#a.exp=e,this}setIssuedAt(e){return this.#a.iat=e,this}setProtectedHeader(e){return this.#t=e,this}async sign(e,t){let r=new CompactSign(this.#a.data());if(r.setProtectedHeader(this.#t),Array.isArray(this.#t?.crit)&&this.#t.crit.includes("b64")&&!1===this.#t.b64)throw new o.uv("JWTs MUST NOT use unencoded payload");return r.sign(e,t)}}}};